<xml xmlns="https://developers.google.com/blockly/xml">
  <variables>
    <variable type="int" id="d+.XBQ?lZ6aIb6CbqiSG">speed</variable>
    <variable type="int" id="e5xr$kn%#$4}UUZk,34:">lineValue</variable>
  </variables>
  <block type="procedures_defreturn" id="n)-+q?P6bW6`_e%LD0VJ" x="-638" y="-537">
    <field name="NAME">followLineBasic</field>
    <comment pinned="false" h="80" w="160">Describe this function...</comment>
    <statement name="STACK">
      <block type="LbIRLine.read" id="sg7Bn(Bx-H,|@p!a}#K#">
        <next>
          <block type="vars_set_int" id="XAOOm[tyy]C?~#)=TO?G">
            <field name="VAR_SET_INT" id="e5xr$kn%#$4}UUZk,34:" variabletype="int">lineValue</field>
            <value name="VALUE">
              <block type="LbIRLine.value" id="R;iiz/i?fc@4fND/ibDz"></block>
            </value>
            <next>
              <block type="LbIRLine.displayOnRGB" id="*7!oi([X`n5k1nR3X_k#">
                <comment pinned="false" h="80" w="160">hiện kết quả lên RGB Leds để quan sát</comment>
                <value name="RGBColor">
                  <block type="LbRGB.colour_picker" id="(HRCmuTMdWN^Eyj368sj">
                    <field name="Color">#009900</field>
                  </block>
                </value>
                <next>
                  <block type="controls_switch" id="5IcZPdXZnqneu.5*|Cp;">
                    <mutation xmlns="http://www.w3.org/1999/xhtml" casebreak="7" default="1"></mutation>
                    <field name="SWVAR" id="e5xr$kn%#$4}UUZk,34:" variabletype="int">lineValue</field>
                    <comment pinned="false" h="80" w="160">kiểm tra vị trí của vạch đen so với Leanbot</comment>
                    <value name="CASE0">
                      <block type="LbIRLine.state" id="fe)RR#bQBWkIs?vk2-=E">
                        <field name="state0">#ffffff</field>
                        <field name="state1">#000000</field>
                        <field name="state2">#ffffff</field>
                        <field name="state3">#ffffff</field>
                      </block>
                    </value>
                    <value name="CASE1">
                      <block type="LbIRLine.state" id=".mmYc36RwIo3}f37QMtx">
                        <field name="state0">#000000</field>
                        <field name="state1">#000000</field>
                        <field name="state2">#000000</field>
                        <field name="state3">#ffffff</field>
                      </block>
                    </value>
                    <value name="CASE2">
                      <block type="LbIRLine.state" id="{zgO#B%b.j=}ShxxhB#9">
                        <field name="state0">#000000</field>
                        <field name="state1">#000000</field>
                        <field name="state2">#ffffff</field>
                        <field name="state3">#ffffff</field>
                      </block>
                    </value>
                    <value name="CASE3">
                      <block type="LbIRLine.state" id="?%v70BO:cT^~,.d9;[mL">
                        <field name="state0">#000000</field>
                        <field name="state1">#ffffff</field>
                        <field name="state2">#ffffff</field>
                        <field name="state3">#ffffff</field>
                      </block>
                    </value>
                    <statement name="DO3">
                      <block type="LbMotion.run" id="P8xJ(nusVifyNoA)w]xe">
                        <field name="MotionType">Run</field>
                        <field name="UnitSpeed">sps</field>
                        <comment pinned="false" h="80" w="160">nếu vạch đen lệch về bên trái thì rẽ trái</comment>
                        <value name="Left">
                          <shadow type="math_number" id="u:=m?F)s2CxhRH0P2q`T">
                            <field name="NUM">0</field>
                          </shadow>
                        </value>
                        <value name="Right">
                          <shadow type="math_number">
                            <field name="NUM">1000</field>
                          </shadow>
                          <block type="vars_get_int" id="!SV.y2eWxPEeWAslZ#$7">
                            <field name="VAR_GET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
                          </block>
                        </value>
                      </block>
                    </statement>
                    <value name="CASE4">
                      <block type="LbIRLine.state" id="B#;h#cHi7j~J*Tp!uAal">
                        <field name="state0">#ffffff</field>
                        <field name="state1">#ffffff</field>
                        <field name="state2">#000000</field>
                        <field name="state3">#ffffff</field>
                      </block>
                    </value>
                    <value name="CASE5">
                      <block type="LbIRLine.state" id="hgN:-ZeFnLXQfUz;~Zr[">
                        <field name="state0">#ffffff</field>
                        <field name="state1">#000000</field>
                        <field name="state2">#000000</field>
                        <field name="state3">#000000</field>
                      </block>
                    </value>
                    <value name="CASE6">
                      <block type="LbIRLine.state" id=".s%Rg!K|%_tM|a$8y^3V">
                        <field name="state0">#ffffff</field>
                        <field name="state1">#ffffff</field>
                        <field name="state2">#000000</field>
                        <field name="state3">#000000</field>
                      </block>
                    </value>
                    <value name="CASE7">
                      <block type="LbIRLine.state" id="B.p)D.gF]oydrc`tJfLG">
                        <field name="state0">#ffffff</field>
                        <field name="state1">#ffffff</field>
                        <field name="state2">#ffffff</field>
                        <field name="state3">#000000</field>
                      </block>
                    </value>
                    <statement name="DO7">
                      <block type="LbMotion.run" id="}t#`yP4NKCHS},H)tDE7">
                        <field name="MotionType">Run</field>
                        <field name="UnitSpeed">sps</field>
                        <comment pinned="false" h="80" w="160">nếu vạch đen lệch về bên phải thì rẽ phải</comment>
                        <value name="Left">
                          <shadow type="math_number">
                            <field name="NUM">1000</field>
                          </shadow>
                          <block type="vars_get_int" id="c:..^M[0MDw~eV4Ku:qT">
                            <field name="VAR_GET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
                          </block>
                        </value>
                        <value name="Right">
                          <shadow type="math_number" id="jx#x%9PX7oB$~|4Q(SIE">
                            <field name="NUM">0</field>
                          </shadow>
                        </value>
                      </block>
                    </statement>
                    <statement name="DEFAULT">
                      <block type="LbMotion.run" id="%9TqM2Z~6CFvh*Xc5xZK">
                        <field name="MotionType">Run</field>
                        <field name="UnitSpeed">sps</field>
                        <comment pinned="false" h="80" w="160">tất cả các trường hợp còn lại thì đi thẳng</comment>
                        <value name="Left">
                          <shadow type="math_number">
                            <field name="NUM">1000</field>
                          </shadow>
                          <block type="vars_get_int" id="5G}t^sO@FzlmJQZZ@oYH">
                            <field name="VAR_GET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
                          </block>
                        </value>
                        <value name="Right">
                          <shadow type="math_number" id="!bij(-g7e?jM6cG}F%m~">
                            <field name="NUM">0</field>
                          </shadow>
                          <block type="vars_get_int" id="djhiRbQtL1v9cGyjlow*">
                            <field name="VAR_GET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
                          </block>
                        </value>
                      </block>
                    </statement>
                  </block>
                </next>
              </block>
            </next>
          </block>
        </next>
      </block>
    </statement>
    <value name="RETURN">
      <block type="logic_compare" id=".zyI9fym?e~$69+~8=12">
        <field name="OP">NEQ</field>
        <value name="A">
          <block type="vars_get_int" id="Ve5Zn!@akQRV2QA6y:H$">
            <field name="VAR_GET_INT" id="e5xr$kn%#$4}UUZk,34:" variabletype="int">lineValue</field>
          </block>
        </value>
        <value name="B">
          <block type="math_number" id="kF4CJWzGrgmPo@(*S|@X">
            <field name="NUM">0</field>
          </block>
        </value>
      </block>
    </value>
  </block>
  <block type="procedures_defnoreturn" id="fS_05#,X?EH+88{O+jw]" x="38" y="-512">
    <field name="NAME">rotate_CD</field>
    <comment pinned="false" h="80" w="160">xoay phải góc C-D</comment>
    <statement name="STACK">
      <block type="LbMotion.run" id="ijW5fT!F(_dLpv#U9?%%">
        <field name="MotionType">Run</field>
        <field name="UnitSpeed">rpm</field>
        <value name="Left">
          <shadow type="math_number">
            <field name="NUM">1000</field>
          </shadow>
          <block type="math_number" id="?`BHgwSU/uW.T6_j?)jy">
            <field name="NUM">30</field>
          </block>
        </value>
        <value name="Right">
          <shadow type="math_number">
            <field name="NUM">1000</field>
          </shadow>
          <block type="math_number" id="P.oX=mKKvg+~!^x=zu=9">
            <field name="NUM">-30</field>
          </block>
        </value>
        <next>
          <block type="LbMotion.waitRotationDeg" id="NO2qh_j{E/ZbXUyZ^8xV">
            <field name="UnitDegree">degrees</field>
            <value name="rotationDeg">
              <shadow type="math_number" id="/`pE3*pAN*[rivF^@4:k">
                <field name="NUM">80</field>
              </shadow>
            </value>
          </block>
        </next>
      </block>
    </statement>
  </block>
  <block type="procedures_defreturn" id="*-rwXGp`/vqvjbO6TGup" x="38" y="-362">
    <field name="NAME">followLineCarefully</field>
    <comment pinned="false" h="45" w="653">đi theo vạch đen, nếu không thấy vạch đen thì đọc thêm nhiều lần nữa cho chắc  </comment>
    <statement name="STACK">
      <block type="controls_repeat" id="b2t@K=43WNwnHVuDPaS3">
        <field name="TIMES">30</field>
        <comment pinned="false" h="80" w="160">đi thêm tối đa 30*1mm = 30mm khi không thấy vạch đen</comment>
        <statement name="DO">
          <block type="procedures_ifreturn" id="rFVRZHMh=|JVf6qA$T]/">
            <mutation value="1"></mutation>
            <value name="CONDITION">
              <block type="procedures_callreturn" id="?P1Nfa/GqVcqNs3YgE;V">
                <mutation name="followLineBasic"></mutation>
              </block>
            </value>
            <value name="VALUE">
              <block type="logic_boolean" id="?H5O@-RQI^1ZNWa|[z/S">
                <field name="BOOL">TRUE</field>
              </block>
            </value>
            <next>
              <block type="LbMotion.waitDistanceMm" id="DpC+FFLeRK)7g,NSB-NU">
                <field name="UnitDistance">mm</field>
                <comment pinned="false" h="80" w="160">đi thêm 1mm rồi đọc lại cảm biến</comment>
                <value name="distanceMm">
                  <shadow type="math_number" id="!E:q8dNOP6o_|d8*=dUV">
                    <field name="NUM">1</field>
                  </shadow>
                </value>
              </block>
            </next>
          </block>
        </statement>
      </block>
    </statement>
    <value name="RETURN">
      <block type="logic_boolean" id="uw]:J!hbRnB3^YX8;*J5">
        <field name="BOOL">FALSE</field>
      </block>
    </value>
  </block>
  <block type="LbIRLine.doManualCalibration" id="t`ani1~y2M3R6EW(p~/J" x="38" y="-162">
    <field name="touchX">TB1A</field>
    <next>
      <block type="vars_set_int" id="a`E%O#e5TbuI$pblZmYH">
        <field name="VAR_SET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
        <comment pinned="false" h="80" w="160">tốc độ di chuyển</comment>
        <value name="VALUE">
          <block type="math_number" id="?y:plm[?jkA6CY~e$pNP">
            <field name="NUM">1000</field>
          </block>
        </value>
        <next>
          <block type="LbMission.beginByServer_end" id=":-{ia!/2ZPdfR%GQC%Ha">
            <field name="missionId">ms11.1</field>
            <statement name="Body">
              <block type="procedures_callnoreturn" id="gya@V]4)s*!?GT#~fv#)">
                <mutation name="rotate_CD"></mutation>
                <next>
                  <block type="controls_whileUntil" id="dwa~|?2D2,0NJt@af%H#">
                    <field name="MODE">WHILE</field>
                    <value name="BOOL">
                      <block type="procedures_callreturn" id="ufe2S4ZzZHBOk5M_h0NV">
                        <mutation name="followLineCarefully"></mutation>
                      </block>
                    </value>
                    <next>
                      <block type="LbMotion.run" id="/}}e!Z#$XJ$76`Ui+Q^7">
                        <field name="MotionType">Run</field>
                        <field name="UnitSpeed">sps</field>
                        <comment pinned="false" h="80" w="160">đi thẳng 4cm nữa để tiến vào vòng B</comment>
                        <value name="Left">
                          <shadow type="math_number">
                            <field name="NUM">1000</field>
                          </shadow>
                          <block type="vars_get_int" id=";Vq},,S-ggkY,Tv7+de9">
                            <field name="VAR_GET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
                          </block>
                        </value>
                        <value name="Right">
                          <shadow type="math_number">
                            <field name="NUM">0</field>
                          </shadow>
                          <block type="vars_get_int" id="wqC,uB4+.$RjY9:5GNCw">
                            <field name="VAR_GET_INT" id="d+.XBQ?lZ6aIb6CbqiSG" variabletype="int">speed</field>
                          </block>
                        </value>
                        <next>
                          <block type="LbMotion.waitDistanceMm" id="o}uxtUKb86Qqxt2fUx^0">
                            <field name="UnitDistance">cm</field>
                            <value name="distanceMm">
                              <shadow type="math_number" id="FBEou=xkcQjV]L}|8u{o">
                                <field name="NUM">4</field>
                              </shadow>
                            </value>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </next>
              </block>
            </statement>
          </block>
        </next>
      </block>
    </next>
  </block>
</xml>